{
  "agent_id": "",
  "channel": "voice",
  "agent_name": "{{agent_name}}",
  "response_engine": {
    "type": "conversation-flow",
    "version": 1,
    "conversation_flow_id": ""
  },
  "webhook_url": "{{webhook_url}}",
  "language": "de-DE",
  "data_storage_setting": "everything",
  "opt_in_signed_url": false,
  "post_call_analysis_data": [
    {
      "type": "string",
      "name": "plz",
      "description": "Swiss postal code (Postleitzahl) of the service location. Return exactly 4 digits, e.g. \"8001\". Even if the call was in English or French, return the 4-digit Swiss postal code.",
      "required": true
    },
    {
      "type": "string",
      "name": "city",
      "description": "City/town of the service location in Switzerland, e.g. \"Zürich\". Always return the German city name.",
      "required": true
    },
    {
      "type": "string",
      "name": "category",
      "description": "Return exactly one of: \"Verstopfung\", \"Leck\", \"Heizung\", \"Boiler\", \"Rohrbruch\", \"Sanitär allgemein\". Always use the German value, even if the call was in English or French.",
      "required": true
    },
    {
      "type": "string",
      "name": "urgency",
      "description": "Return exactly one of: \"notfall\", \"dringend\", \"normal\". Lowercase German only. Even if the caller said \"emergency\" or \"urgent\", map to the German equivalent.",
      "required": true
    },
    {
      "type": "string",
      "name": "description",
      "description": "1-3 sentence summary of the problem IN GERMAN. Include key symptoms and affected area (Bad/Küche/Keller etc.). Never include personal data. Even if the call was in English or French, write the summary in German.",
      "required": true
    }
  ],
  "version": 1,
  "is_published": false,
  "version_title": "{{agent_name}}",
  "post_call_analysis_model": "gpt-4.1-mini",
  "pii_config": {
    "mode": "post_call",
    "categories": []
  },
  "analysis_successful_prompt": "Evaluate whether the agent had a successful call with the user. For a successful call, the agent should have a complete conversation with user, finished the task, and have not ran into technical issues, or caused user frustration. Besides, the agent was not blocked by a call screen or encountered voicemail.",
  "analysis_summary_prompt": "Write a 1-3 sentence summary of the call based on the call transcript. Should capture the important information and actions taken during the call.",
  "analysis_user_sentiment_prompt": "Evaluate user's sentiment, mood and satisfaction level.",
  "voice_id": "{{voice_id}}",
  "max_call_duration_ms": 420000,
  "interruption_sensitivity": 0.9,
  "allow_user_dtmf": true,
  "user_dtmf_options": {},
  "conversationFlow": {
    "conversation_flow_id": "",
    "version": 1,
    "global_prompt": "Du bist der telefonische Assistent von {{business_name}}. Du nimmst Schadensmeldungen im Bereich Sanitär und Heizung auf.\n\nSTIL\n- Sprich natürlich und ruhig — wie ein erfahrener Disponent, nicht wie ein Roboter.\n- Kurze Sätze. Keine Aufzählungen vorlesen. Nie mehrere Fragen in einem Satz.\n- Empathische Mikro-Reaktionen: „Verstehe.“, „Das klingt unangenehm.“, „Alles klar.“ — bevor du die nächste Frage stellst.\n- Verwende IMMER „Postleitzahl“, NIE „PLZ“.\n- Maximal 7 Fragen pro Gespräch.\n\nSPRACHE\n- Standard: Hochdeutsch. Schweizerdeutsch verstehen, auf Hochdeutsch antworten.\n- Verwende KEINE englischen Wörter oder Phrasen auf Deutsch (kein „Okay“, „sorry“, „Checklist“).\n- Vollständiger Sprachwechsel: Wenn der Anrufer auf Englisch oder Französisch spricht, wechsle KOMPLETT in diese Sprache — Begrüßung, Fragen, Zusammenfassung, Abschluss. Die Post-Call-Analyse (plz, city, category, urgency, description) bleibt IMMER auf Deutsch.\n\nTHEMA\n- Nur Sanitär- und Heizungsthemen. Bei anderen Anliegen höflich ablehnen.\n- Keine Aufnahme/Recording erwähnen.\n\nDATENSCHUTZ\n- Keine persönlichen Daten in die Beschreibung (keine Namen, Telefonnummern, E-Mails, exakte Adressen).\n\nPFLICHTFELDER (müssen am Ende vorliegen)\n1) Postleitzahl des Einsatzortes (Schweiz, 4 Ziffern)\n2) Ort/Stadt des Einsatzortes\n3) Kategorie — genau eine: Verstopfung | Leck | Heizung | Boiler | Rohrbruch | Sanitär allgemein\n4) Dringlichkeit — genau eine (Kleinschreibung): notfall | dringend | normal\n5) Kurzbeschreibung (1–3 Sätze, ohne PII)\n\nCUSTOM ANALYSIS DATA OUTPUT\nAuch wenn das Gespräch auf Englisch oder Französisch geführt wurde: Alle Werte IMMER auf Deutsch ausgeben.\n- plz: Postleitzahl (nur die 4 Ziffern)\n- city: Ort/Stadt\n- category: exakt einer der 6 Werte (Verstopfung, Leck, Heizung, Boiler, Rohrbruch, Sanitär allgemein)\n- urgency: exakt \"notfall\" oder \"dringend\" oder \"normal\" (kleinschreibung)\n- description: 1–3 Sätze Problembeschreibung ohne PII (auf Deutsch)",
    "nodes": [
      {
        "instruction": {
          "type": "static_text",
          "text": "{{greeting_text}}"
        },
        "always_edge": {
          "destination_node_id": "node-intake",
          "id": "always-edge-welcome",
          "transition_condition": {
            "type": "prompt",
            "prompt": "Always"
          }
        },
        "name": "Welcome Node",
        "edges": [],
        "start_speaker": "agent",
        "id": "start-node",
        "type": "conversation",
        "display_position": {
          "x": 232,
          "y": 24
        }
      },
      {
        "instruction": {
          "type": "prompt",
          "text": "Du führst ein natürliches Gespräch, um eine Schadensmeldung aufzunehmen.\n\nABLAUF\n1. Lass den Anrufer zuerst erzählen, was passiert ist. Hör zu.\n2. Reagiere kurz empathisch („Verstehe.“ / „Das klingt unangenehm.“).\n3. Leite die Kategorie möglichst aus der Beschreibung ab. Nur wenn unklar: „Handelt es sich eher um ein Leck, eine Verstopfung oder etwas anderes?“. Nie alle 6 Kategorien vorlesen.\n4. Frage nach Postleitzahl und Ort: „Wo befindet sich der Einsatzort — können Sie mir die Postleitzahl und den Ort nennen?“\n5. Frage nach Dringlichkeit: „Ist das ein Notfall, dringend, oder kann es normal eingeplant werden?“\n6. Fasse kurz zusammen und bitte um Bestätigung.\n\nREGELN\n- Nie zwei Fragen in einem Satz. Immer nur eine Sache auf einmal fragen.\n- Wenn der Anrufer genervt oder kurz angebunden ist: Sammle nur das Minimum und schliesse zügig ab.\n- Wenn eine Information schon aus dem Gespräch hervorgeht: NICHT nochmal fragen.\n- Verwende IMMER „Postleitzahl“, NIE „PLZ“.\n- Wenn das Anliegen kein Sanitär-/Heizungsthema ist: setze out_of_scope=true.\n- Wenn alle Pflichtfelder vorhanden sind (Postleitzahl, Ort, Kategorie, Dringlichkeit, Beschreibung): setze intake_complete=true, sonst false.\n\nSPRACHE\n- Wenn der Anrufer Englisch spricht: führe das ganze Gespräch auf Englisch.\n- Wenn der Anrufer Französisch spricht: führe das ganze Gespräch auf Französisch.\n- Die Post-Call-Analyse-Werte (category, urgency, description) immer auf Deutsch ausgeben, unabhängig von der Gesprächssprache."
        },
        "name": "Intake Node",
        "edges": [],
        "id": "node-intake",
        "type": "conversation",
        "display_position": {
          "x": 623,
          "y": 310
        },
        "skip_response_edge": {
          "destination_node_id": "node-logic-split",
          "id": "skip-response-edge-intake",
          "transition_condition": {
            "type": "prompt",
            "prompt": "Skip response"
          }
        }
      },
      {
        "name": "Logic Split Node",
        "edges": [
          {
            "destination_node_id": "node-out-of-scope",
            "id": "edge-out-of-scope",
            "transition_condition": {
              "type": "prompt",
              "prompt": "out_of_scope is true (the user's request is not about plumbing or heating)"
            }
          },
          {
            "destination_node_id": "node-closing",
            "id": "edge-intake-complete",
            "transition_condition": {
              "type": "prompt",
              "prompt": "intake_complete is true (all required fields have been collected: plz, city, category, urgency, description)"
            }
          }
        ],
        "id": "node-logic-split",
        "else_edge": {
          "destination_node_id": "node-intake",
          "id": "edge-logic-else",
          "transition_condition": {
            "type": "prompt",
            "prompt": "Else"
          }
        },
        "type": "branch",
        "display_position": {
          "x": 989,
          "y": 704
        }
      },
      {
        "instruction": {
          "type": "static_text",
          "text": "{{closing_text}}"
        },
        "name": "Closing Node",
        "edges": [],
        "id": "node-closing",
        "type": "conversation",
        "display_position": {
          "x": 1363,
          "y": 796
        },
        "skip_response_edge": {
          "destination_node_id": "end-call-node",
          "id": "skip-response-edge-closing",
          "transition_condition": {
            "type": "prompt",
            "prompt": "Skip response"
          }
        }
      },
      {
        "instruction": {
          "type": "prompt",
          "text": "Danke. Dafür sind wir nicht zuständig. Bei Sanitär- oder Heizungsanliegen helfe ich gerne."
        },
        "name": "Out-of-scope Closing",
        "edges": [],
        "id": "node-out-of-scope",
        "type": "conversation",
        "display_position": {
          "x": 943,
          "y": 944
        },
        "skip_response_edge": {
          "destination_node_id": "end-call-node",
          "id": "skip-response-edge-oos",
          "transition_condition": {
            "type": "prompt",
            "prompt": "Skip response"
          }
        }
      },
      {
        "name": "End Call",
        "id": "end-call-node",
        "type": "end",
        "display_position": {
          "x": 1766,
          "y": 1116
        },
        "instruction": {
          "type": "prompt",
          "text": "Politely end the call"
        }
      }
    ],
    "start_node_id": "start-node",
    "start_speaker": "agent",
    "model_choice": {
      "type": "cascading",
      "model": "gpt-4.1"
    },
    "tool_call_strict_mode": true,
    "knowledge_base_ids": [],
    "kb_config": {
      "top_k": 3,
      "filter_score": 0.6
    },
    "begin_tag_display_position": {
      "x": 46,
      "y": -43
    },
    "is_published": false,
    "flex_mode": true,
    "is_transfer_cf": false
  }
}
